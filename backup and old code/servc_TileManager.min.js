!function(){angular.module("barickOSApp").service("tileManager",function(){function i(){var i=17,e=angular.element(".tiles-container").width()-i;u="xs";s=12,g=Math.floor(e/s),e>=1200?(u="lg",s=16,g=Math.floor(e/s)):e>=992?u="md":e>=768?u="sm":(u="xs",s=4,g=Math.floor((e+i)/s)),p=2*g,v=2*p}function e(){if("xs"==u)for(var i in f)f[i].size="big"==f[i].size?"medium":f[i].size}function r(){fillCapacity=0;for(var i in f)"small"==f[i].size?fillCapacity+=1:"medium"==f[i].size?fillCapacity+=4:"rectangle"==f[i].size?fillCapacity+=8:"big"==f[i].size&&(fillCapacity+=16);var e=s*Math.ceil(fillCapacity/s)*2;c={};for(var r=0,t=1,i=1;e>=i;i++){r++,r>s&&(r=1,t++);var n={};n.indX=r,n.indY=t,n.id=r+"x"+t,n.occupiedBy="none",n.top=(t-1)*g,n.left=(r-1)*g,n.type="",c[n.id]=n}}function t(){for(var i in c)c[i].occupiedBy="none",c[i].type=""}function n(){y=0;var i="";for(var e in d)i=d[e],gridId=o(f[i]),f[i].gridId=gridId,f[i].width="small"==f[i].size?g:"medium"==f[i].size?p:v,f[i].height="small"==f[i].size?g:"big"==f[i].size?v:p,f[i].bgColor=f[i].bgColor||h[Math.floor(Math.random()*h.length)],f[i].top=c[gridId].top,f[i].left=c[gridId].left,y=f[i].top+f[i].height>y?f[i].top+f[i].height:y}function o(i){for(var e in c)if("none"==c[e].occupiedBy){if("small"==i.size)return c[e].occupiedBy=i.id,c[e].type="startGrid",e;if(l(c[e].id,i.size))return a(c[e].id,i.size,i.id),c[e].type="startGrid",e}console.log("No Grid Avaialble for Tile id="+i.id)}function l(i,e){for(var r="medium"==e?2:4,t="big"==e?4:2,n=c[i].indX,o=c[i].indY,l=n+(r-1),a=o+(t-1),d="",f=!1,s=n;l>=s;s++){for(var u=o;a>=u;u++)if(d=s+"x"+u,void 0==c[d]||void 0==typeof c[d]||"none"!=c[d].occupiedBy){f=!0;break}if(f)break}return!f}function a(i,e,r){for(var t="medium"==e?2:4,n="big"==e?4:2,o=c[i].indX,l=c[i].indY,a=o+(t-1),d=l+(n-1),f="",s=o;a>=s;s++)for(var u=l;d>=u;u++)f=s+"x"+u,c[f].occupiedBy=r}var d=[],f={},c={},s=0,u="xs",g=0,p=0,v=0,y=200,h=["#632F00","#B01E00","#C1004F","#4617B4","#008287","#199900","#00C13F","#FF2E12","#FF1D77","#AA40FF","#1FAEFF","#000","#00A3A3","#FE7C22"];this.tilify=function(t){return f=t.tiles,d=t.tileOrder,i(),e(),r(),n(),t.tiles=f,t.tileOrder=d,t},this.reTilify=function(i){return f=i.tiles,d=i.tileOrder,console.log("tileOrder: "+JSON.stringify(d)),t(),n(),i.tiles=f,i.tileOrder=d,i},this.getClearSpaceDivPosition=function(){return y},this.getGrids=function(){return c}})}();